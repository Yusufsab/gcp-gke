steps:
- name: 'gcr.io/cloud-builders/docker'
  args: ['build', '-t', 'us-central1-docker.pkg.dev/kubernets-project-440302/gke-repo/quickstart-image', './app1' ]
  id: 'Build Docker Image'

  # images:
  # - 'us-central1-docker.pkg.dev/kubernets-project-440302/gke-repo/quickstart-image'

- name: 'gcr.io/cloud-builders/docker'
  args: ['push', 'us-central1-docker.pkg.dev/kubernets-project-440302/gke-repo/quickstart-image' ]
  id: 'Push Docker Image'

- name: 'gcr.io/cloud-builders/docker'
  args: ['build', '-t', 'us-central1-docker.pkg.dev/kubernets-project-440302/gke-repo/flask-image', './app2' ]
  id: 'Build Docker Image2'

  # images:
  # - 'us-central1-docker.pkg.dev/kubernets-project-440302/gke-repo/quickstart-image'

- name: 'gcr.io/cloud-builders/docker'
  args: ['push', 'us-central1-docker.pkg.dev/kubernets-project-440302/gke-repo/flask-image' ]
  id: 'Push Docker Image2'


- name: 'google/cloud-sdk:latest'
  entrypoint: 'sh'
  args:
  - -xe
  - -c
  - |
    gcloud deploy apply --file deploy/pipeline.yaml --region=us-central1
    gcloud deploy apply --file deploy/dev.yaml --region=us-central1
    gcloud deploy apply --file deploy/dev.yaml --region=us-central1
# Deploy to GKE (Google Kubernetes Engine)
- name: 'gcr.io/cloud-builders/kubectl'
  args:
      - 'apply'
      - '-f'
      - 'gs://$https://console.cloud.google.com/storage/browser/c57b0fe828744da9958ffe5aa18debfa_clouddeploy/app1.yml'
    

  ##  gcloud deploy releases create app1-release-delivery-pipeline-gke-cird-pipeline-region-us-central1-from-k8s-manifest-/kubernetes/app1.yaml
  #  gcloud deploy releases create app1-release --project=kubernets-project-440302 --region=us-central1 --delivery-pipeline=delivery-pipeline-gke-cird-pipeline --annotations=build=1.0.0,env=production --description=delivery-pipeline-gke-cird-pipeline    gcloud deploy releases create app1-release-delivery-pipeline-gke-cird-pipeline-region-us-central1-from-k8s-manifest-/kubernetes/app2.yaml


options:
  logging: CLOUD_LOGGING_ONLY
